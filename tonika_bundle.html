<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Tonika Bundle</title>

    <!-- 1) CORE THEME TOKENS -->
    <link rel="stylesheet" href="css/tonika-core.css" />

    <!-- 2) SHARED COMPONENTS (buttons, inputs, cards) -->
    <link rel="stylesheet" href="css/tonika-components.css" />

    <!-- 3) PAGE LAYOUT -->
    <link rel="stylesheet" href="css/layout.css" />

    <!-- 4) MODULE STYLES -->
    <link rel="stylesheet" href="css/chordonika.css" />
    <link rel="stylesheet" href="css/catchonika.css" />
    <link rel="stylesheet" href="css/clavonika.css" />
</head>

<body class="tonika-theme-dark">
<header>
    <h1>Tonika</h1>
</header>

<main class="tonika-container">
    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="Tonika modules">
        <button class="active" onclick="openTab(0)" role="tab" aria-selected="true">Catchonika</button>
        <button onclick="openTab(1)" role="tab" aria-selected="false">Chordonika</button>
        <button onclick="openTab(2)" role="tab" aria-selected="false">Tab 3</button>
        <button onclick="openTab(3)" role="tab" aria-selected="false">Tab 4</button>
        <button onclick="openTab(4)" role="tab" aria-selected="false">Tab 5</button>
        <button onclick="openTab(5)" role="tab" aria-selected="false">Midonika</button>
    </div>

    <div class="tab-content">
        <!-- Catchonika -->
        <section class="active">
            <link rel="stylesheet" href="css/catchonika.css" />
            <div id="catchonika-card"></div>
        </section>

        <!-- Chordonika -->
        <section>
            <div id="chord-selector"></div>
        </section>

        <section>Content for Tab 3</section>
        <section>Content for Tab 4</section>
        <section>Content for Tab 5</section>

        <!-- Midonika -->
        <section>
            <div id="midi-component"></div>
        </section>
    </div>

    <!-- 88-key piano roll -->
    <div class="roll88">
        <div id="piano-container"></div>
    </div>
</main>

<footer>
    <p>Â© 2025 My Piano Project</p>
</footer>

<script>
    function openTab(index) {
        const tabs = document.querySelectorAll('.tabs button');
        const sections = document.querySelectorAll('.tab-content section');

        tabs.forEach((tab, i) => {
            const active = i === index;
            tab.classList.toggle('active', active);
            tab.setAttribute('aria-selected', String(active));
            sections[i].classList.toggle('active', active);
        });
    }
</script>

<!-- ===== Scripts: order matters ===== -->
<!-- Core modules -->
<script src="js/clavonika.js"></script>
<script src="js/jackonika.js"></script>

<!-- Vendor for Catchonika -->
<script src="vendor/midiwriter.js"></script>

<!-- Module scripts -->
<script src="js/catchonika.js"></script>
<script src="js/chordonika.js"></script>
<script src="js/midonika.js"></script>

<!-- ===== Initialize modules ===== -->
<script>
    // Single Clavonika instance
    const piano = Clavonika.init('piano-container');
    window.piano = piano; // optional global

    // Jackonika bridges external MIDI to the piano
    Jackonika.init({
        onNoteOn:  (note, vel) => piano.noteOn?.(note),
        onNoteOff: (note)      => piano.noteOff?.(note),
    });

    // Chordonika (Chord selector + visualizer)
    new Chordonika({
        mount: "#chord-selector",
        mode: "card",
        onChordSelected: (chord) => {
            console.log("Selected chord:", chord);
        }
    });

    // Midonika (MIDI event logger/monitor)
    window.midonika = new Midonika('midi-component');

    // Catchonika (MIDI capture/record)
    new window.Catchonika({
        mount: "#catchonika-card",
        mode: "card",
        bufferMinutes: 60,
        defaultBpm: 120,
        groupByChannel: false,
    });
</script>
</body>
</html>